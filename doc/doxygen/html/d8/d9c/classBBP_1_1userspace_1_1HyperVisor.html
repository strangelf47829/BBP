<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BBP Embedded kernel: BBP::userspace::HyperVisor Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BBP Embedded kernel
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
   <div id="projectbrief">Multi ring OS development on embedded systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/d6f/namespaceBBP.html">BBP</a></li><li class="navelem"><a class="el" href="../../de/dfe/namespaceBBP_1_1userspace.html">userspace</a></li><li class="navelem"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html">HyperVisor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a>  </div>
  <div class="headertitle">
<div class="title">BBP::userspace::HyperVisor Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d0/dde/Hyperv_8h_source.html">Hyperv.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for BBP::userspace::HyperVisor:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d07/classBBP_1_1userspace_1_1HyperVisor__coll__graph.png" border="0" usemap="#BBP_1_1userspace_1_1HyperVisor_coll__map" alt="Collaboration graph"/></div>
<map name="BBP_1_1userspace_1_1HyperVisor_coll__map" id="BBP_1_1userspace_1_1HyperVisor_coll__map">
<area shape="rect" title=" " alt="" coords="1119,3012,1356,3133"/>
<area shape="rect" href="../../d0/dc2/classBBP_1_1userspace_1_1BinaryExecutable.html" title=" " alt="" coords="960,1571,1203,1795"/>
<area shape="rect" href="../../d5/d8b/structBBP_1_1userspace_1_1Thread.html" title=" " alt="" coords="2695,1857,2870,2463"/>
<area shape="rect" href="../../df/ddc/structBBP_1_1std_1_1PAGE.html" title=" " alt="" coords="557,432,710,539"/>
<area shape="rect" title=" " alt="" coords="1261,5,1395,83"/>
<area shape="rect" href="../../df/ddc/structBBP_1_1std_1_1PAGE.html" title=" " alt="" coords="1603,204,1759,296"/>
<area shape="rect" href="../../df/ddc/structBBP_1_1std_1_1PAGE.html" title=" " alt="" coords="245,439,432,531"/>
<area shape="rect" href="../../df/ddc/structBBP_1_1std_1_1PAGE.html" title=" " alt="" coords="1703,432,1894,539"/>
<area shape="rect" href="../../df/ddc/structBBP_1_1std_1_1PAGE.html" title=" " alt="" coords="835,432,1053,539"/>
<area shape="rect" href="../../df/ddc/structBBP_1_1std_1_1PAGE.html" title=" " alt="" coords="1570,2679,1734,2786"/>
<area shape="rect" href="../../df/ddc/structBBP_1_1std_1_1PAGE.html" title=" " alt="" coords="2631,432,2785,539"/>
<area shape="rect" href="../../df/ddc/structBBP_1_1std_1_1PAGE.html" title=" " alt="" coords="3319,432,3473,539"/>
<area shape="rect" href="../../df/ddc/structBBP_1_1std_1_1PAGE.html" title=" " alt="" coords="2349,439,2507,531"/>
<area shape="rect" title=" " alt="" coords="705,211,836,289"/>
<area shape="rect" title=" " alt="" coords="3607,5,3662,83"/>
<area shape="rect" href="../../d3/de6/structBBP_1_1userspace_1_1MemoryRegion.html" title=" " alt="" coords="1033,211,1263,289"/>
<area shape="rect" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html" title=" " alt="" coords="2659,799,2906,891"/>
<area shape="rect" href="../../de/d21/classBBP_1_1std_1_1Stack.html" title=" " alt="" coords="3229,1108,3384,1493"/>
<area shape="rect" href="../../de/d21/classBBP_1_1std_1_1Stack.html" title=" " alt="" coords="3409,660,3567,1031"/>
<area shape="rect" href="../../d8/da2/structBBP_1_1userspace_1_1register__t.html" title=" " alt="" coords="3976,2672,4168,2793"/>
<area shape="rect" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html" title=" " alt="" coords="2931,799,3163,891"/>
<area shape="rect" title=" " alt="" coords="1767,5,1846,83"/>
<area shape="rect" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html" title=" " alt="" coords="2155,439,2325,531"/>
<area shape="rect" title=" " alt="" coords="1638,5,1743,83"/>
<area shape="rect" title=" " alt="" coords="2046,5,2085,83"/>
<area shape="rect" title=" " alt="" coords="9,5,60,83"/>
<area shape="rect" href="../../d5/d9e/structBBP_1_1userspace_1_1Instruction_1_1Arg.html" title=" " alt="" coords="1449,447,1679,524"/>
<area shape="rect" href="../../d6/d73/classBBP_1_1std_1_1ResourceManager.html" title=" " alt="" coords="1539,1145,1741,1457"/>
<area shape="rect" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html" title=" " alt="" coords="1451,799,1658,891"/>
<area shape="rect" title=" " alt="" coords="220,211,292,289"/>
<area shape="rect" title=" " alt="" coords="317,211,419,289"/>
<area shape="rect" title=" " alt="" coords="1364,447,1425,524"/>
<area shape="rect" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html" title=" " alt="" coords="1822,792,2029,899"/>
<area shape="rect" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html" title=" " alt="" coords="944,799,1219,891"/>
<area shape="rect" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html" title=" " alt="" coords="1827,2843,2021,2949"/>
<area shape="rect" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html" title=" " alt="" coords="3592,799,3816,891"/>
<area shape="rect" href="../../d7/def/structBBP_1_1std_1_1AbstractGCEntry.html" title=" " alt="" coords="1993,189,2183,311"/>
<area shape="rect" title=" " alt="" coords="2913,211,2978,289"/>
<area shape="rect" title=" " alt="" coords="3387,211,3450,289"/>
<area shape="rect" title=" " alt="" coords="3749,447,3800,524"/>
<area shape="rect" href="../../d0/dfc/structBBP_1_1userspace_1_1Instruction.html" title=" " alt="" coords="2437,807,2635,884"/>
<area shape="rect" title=" " alt="" coords="3003,211,3069,289"/>
<area shape="rect" href="../../d5/d1c/structBBP_1_1userspace_1_1Instruction_1_1Head.html" title=" " alt="" coords="2909,439,3107,531"/>
<area shape="rect" title=" " alt="" coords="3132,447,3295,524"/>
<area shape="rect" title=" " alt="" coords="2552,211,2595,289"/>
<area shape="rect" title=" " alt="" coords="4055,2121,4153,2199"/>
<area shape="rect" title=" " alt="" coords="3777,1644,3837,1721"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a700fe3adfc4bee534fb242852eaf74d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dfe/namespaceBBP_1_1userspace.html#ada35073b18ce8a7b788f5bd62ffd477d">pid_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a700fe3adfc4bee534fb242852eaf74d0">allocateThread</a> ()</td></tr>
<tr class="separator:a700fe3adfc4bee534fb242852eaf74d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a896aeb26e67c14605bc5885d4338a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d8b/structBBP_1_1userspace_1_1Thread.html">userspace::Thread</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#ad9a896aeb26e67c14605bc5885d4338a">spawnThread</a> (<a class="el" href="../../d3/d63/classBBP_1_1std_1_1ELF_1_1ELFBuilder.html">std::ELF::ELFBuilder</a> &amp;binary, <a class="el" href="../../d6/d73/classBBP_1_1std_1_1ResourceManager.html">std::ResourceManager</a> *allocator)</td></tr>
<tr class="separator:ad9a896aeb26e67c14605bc5885d4338a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b80807f61133aed0d6cad53f74330c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a1b80807f61133aed0d6cad53f74330c7">destroyThread</a> (<a class="el" href="../../de/dfe/namespaceBBP_1_1userspace.html#ada35073b18ce8a7b788f5bd62ffd477d">userspace::pid_t</a> pid)</td></tr>
<tr class="separator:a1b80807f61133aed0d6cad53f74330c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf57271f473cebb9e24e3afbd9b21e6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#acf57271f473cebb9e24e3afbd9b21e6b">FetchActiveThreadInstruction</a> ()</td></tr>
<tr class="separator:acf57271f473cebb9e24e3afbd9b21e6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:aafbfe5628b61bda24d4f6e86455c6fb4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d98/namespaceBBP_1_1std.html#abd480c5a3803a8d9621cfdc79b051a7c">std::size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#aafbfe5628b61bda24d4f6e86455c6fb4">activeThreadCount</a> = 0</td></tr>
<tr class="separator:aafbfe5628b61bda24d4f6e86455c6fb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb775465cf5dc74bcb411a5969ebddd8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d98/namespaceBBP_1_1std.html#a4e12dc72cb7f796de80bc851c86c658e">std::index_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#adb775465cf5dc74bcb411a5969ebddd8">activeThread</a> = 0</td></tr>
<tr class="separator:adb775465cf5dc74bcb411a5969ebddd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf04c5636244f4eb89c24496b8f709b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html">std::STATIC_PAGE</a>&lt; <a class="el" href="../../d5/d8b/structBBP_1_1userspace_1_1Thread.html">Thread</a>, <a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a572509d057f0f9af086655c9ae0fef73">threadCount</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a3cf04c5636244f4eb89c24496b8f709b">threads</a></td></tr>
<tr class="separator:a3cf04c5636244f4eb89c24496b8f709b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c21ea8a3ad0e9a201f0770b70870e5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/dc2/classBBP_1_1userspace_1_1BinaryExecutable.html">BinaryExecutable</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a5c21ea8a3ad0e9a201f0770b70870e5d">sharedlib</a></td></tr>
<tr class="separator:a5c21ea8a3ad0e9a201f0770b70870e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a572509d057f0f9af086655c9ae0fef73"><td class="memItemLeft" align="right" valign="top">static constexpr <a class="el" href="../../dd/d98/namespaceBBP_1_1std.html#abd480c5a3803a8d9621cfdc79b051a7c">std::size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a572509d057f0f9af086655c9ae0fef73">threadCount</a> = 16</td></tr>
<tr class="separator:a572509d057f0f9af086655c9ae0fef73"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d0/dde/Hyperv_8h_source.html#l00014">14</a> of file <a class="el" href="../../d0/dde/Hyperv_8h_source.html">Hyperv.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a700fe3adfc4bee534fb242852eaf74d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a700fe3adfc4bee534fb242852eaf74d0">&#9670;&nbsp;</a></span>allocateThread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dfe/namespaceBBP_1_1userspace.html#ada35073b18ce8a7b788f5bd62ffd477d">BBP::userspace::pid_t</a> BBP::userspace::HyperVisor::allocateThread </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/df1/ThreadState_8cpp_source.html#l00004">4</a> of file <a class="el" href="../../d8/df1/ThreadState_8cpp_source.html">ThreadState.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;{</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b80807f61133aed0d6cad53f74330c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b80807f61133aed0d6cad53f74330c7">&#9670;&nbsp;</a></span>destroyThread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BBP::userspace::HyperVisor::destroyThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dfe/namespaceBBP_1_1userspace.html#ada35073b18ce8a7b788f5bd62ffd477d">userspace::pid_t</a>&#160;</td>
          <td class="paramname"><em>pid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/df1/ThreadState_8cpp_source.html#l00033">33</a> of file <a class="el" href="../../d8/df1/ThreadState_8cpp_source.html">ThreadState.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// Get thread</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    userspace::Thread *t = &amp;<a class="code" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a3cf04c5636244f4eb89c24496b8f709b">threads</a>.static_data[pid];</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// Unload executable</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    t-&gt;executable.unloadExecutable();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// Free up TLS</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    t-&gt;allocator-&gt;free(t-&gt;TLS.data);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    t-&gt;TLS = std::PAGE&lt;std::string_element&gt;(0, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// Set inactive</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    t-&gt;active = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor_a1b80807f61133aed0d6cad53f74330c7_cgraph.png" border="0" usemap="#d8/d9c/classBBP_1_1userspace_1_1HyperVisor_a1b80807f61133aed0d6cad53f74330c7_cgraph" alt=""/></div>
<map name="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_a1b80807f61133aed0d6cad53f74330c7_cgraph" id="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_a1b80807f61133aed0d6cad53f74330c7_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,208,80"/>
<area shape="rect" href="../../d6/d73/classBBP_1_1std_1_1ResourceManager.html#a88b2740fa8c5b5e30e6ef08cb8c7d883" title=" " alt="" coords="277,5,478,47"/>
<area shape="rect" href="../../d0/dc2/classBBP_1_1userspace_1_1BinaryExecutable.html#a9d5e6d71b96e1ace8d45c87dedeab11f" title=" " alt="" coords="256,71,499,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor_a1b80807f61133aed0d6cad53f74330c7_icgraph.png" border="0" usemap="#d8/d9c/classBBP_1_1userspace_1_1HyperVisor_a1b80807f61133aed0d6cad53f74330c7_icgraph" alt=""/></div>
<map name="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_a1b80807f61133aed0d6cad53f74330c7_icgraph" id="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_a1b80807f61133aed0d6cad53f74330c7_icgraph">
<area shape="rect" title=" " alt="" coords="288,5,491,47"/>
<area shape="rect" href="../../d9/d6f/namespaceBBP.html#a0ba2e2ff83f9f917f9811058a5d02a0b" title=" " alt="" coords="108,13,240,39"/>
<area shape="rect" href="../../db/db7/Start_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title=" " alt="" coords="5,13,60,39"/>
</map>
</div>

</div>
</div>
<a id="acf57271f473cebb9e24e3afbd9b21e6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf57271f473cebb9e24e3afbd9b21e6b">&#9670;&nbsp;</a></span>FetchActiveThreadInstruction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BBP::userspace::HyperVisor::FetchActiveThreadInstruction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d95/InstructionCycle_8cpp_source.html#l00006">6</a> of file <a class="el" href="../../d5/d95/InstructionCycle_8cpp_source.html">InstructionCycle.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <span class="comment">// Check if active thread is within bounds</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#adb775465cf5dc74bcb411a5969ebddd8">activeThread</a> &gt;= <a class="code" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a572509d057f0f9af086655c9ae0fef73">threadCount</a>)</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        <span class="comment">// Signal Processor fault</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        <a class="code" href="../../d0/def/Signal_8h.html#a82e69d819748cab5933309bba1999f7c">__SIGNAL__</a>(<a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a11c4192c4c4747dbbd9300b0bc2db5d7">SIGINV</a>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    }</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">// Get active thread</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    Thread *currentThread = &amp;<a class="code" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a3cf04c5636244f4eb89c24496b8f709b">threads</a>.static_data[<a class="code" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#adb775465cf5dc74bcb411a5969ebddd8">activeThread</a>];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// If thread is inactive, raise signal</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">if</span> (currentThread-&gt;active == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <a class="code" href="../../d0/def/Signal_8h.html#a82e69d819748cab5933309bba1999f7c">__SIGNAL__</a>(<a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#af139a9b42bd35d198ce80ed26f7d2efe">SIGTHREXP</a>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    }</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// Read program counter (eip) and convert from virtual memory to physical memory</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#ae104641b17c021a901add93f7bc5d808">std::word</a> programCounter = currentThread-&gt;executable.virtualToPhysical(<a class="code" href="../../de/dfe/namespaceBBP_1_1userspace.html#a484d19b0d23141290394e25753c95bfb">readRegister</a>(currentThread-&gt;eip));</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// Clear instruction</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    currentThread-&gt;instruction = userspace::Instruction();</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">try</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="comment">// Decode word</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        currentThread-&gt;instruction.header.prefix = <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, programCounter + 0);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        currentThread-&gt;instruction.header.opcode = <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, programCounter + 1);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        currentThread-&gt;instruction.header.suffix = <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, programCounter + 2);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="comment">// Decode last eight bits</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a4926ba934876e4a1028b9abb47edbc56">std::byte</a> flagsAndArgs = <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, programCounter + 3);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        currentThread-&gt;instruction.header.args = flagsAndArgs &amp; 0x0F;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        currentThread-&gt;instruction.header.flags = (flagsAndArgs &amp; 0xF0) &gt;&gt; 4;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="comment">// Now for arguments.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#ae104641b17c021a901add93f7bc5d808">std::word</a> executableIndex = programCounter + 4;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a4e12dc72cb7f796de80bc851c86c658e">std::index_t</a> argumentIndex = 0; argumentIndex &lt; currentThread-&gt;instruction.header.args; argumentIndex++)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            <span class="comment">// Decide if argument is a literal</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <span class="keywordtype">bool</span> isLiteral = !(currentThread-&gt;instruction.header.prefix &amp; (1 &lt;&lt; argumentIndex));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="comment">// Decode word</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#ae104641b17c021a901add93f7bc5d808">std::word</a> decoded = 0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            decoded |= <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, executableIndex + 0) &lt;&lt; 24;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            decoded |= <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, executableIndex + 1) &lt;&lt; 16;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            decoded |= <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, executableIndex + 2) &lt;&lt;  8;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            decoded |= <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, executableIndex + 3) &lt;&lt;  0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            executableIndex += 4;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="comment">// If literal, set argument and stop</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">if</span> (isLiteral)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                currentThread-&gt;instruction.args[argumentIndex].data = decoded;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                currentThread-&gt;instruction.args[argumentIndex].isLiteralArg = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="comment">// Get decoded or referenced </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            currentThread-&gt;instruction.args[argumentIndex].referenced   = !!((decoded &gt;&gt; 24) &amp; 0b10000000);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            currentThread-&gt;instruction.args[argumentIndex].dereferenced = !!((decoded &gt;&gt; 24) &amp; 0b01000000);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="comment">// Next, get offset and trailer count</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            currentThread-&gt;instruction.args[argumentIndex].offset = ((decoded &gt;&gt; 24) &amp; 0b00111100) &gt;&gt; 2;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            currentThread-&gt;instruction.args[argumentIndex].trailerCount = ((decoded &gt;&gt; 24) &amp; 0b0000011);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="comment">// Save 20 bits of decoded into args</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            currentThread-&gt;instruction.args[argumentIndex].data = decoded &amp; 0xfffff;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="comment">// Now decode trailers</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a46765daa6b14b3e45c22ad4071efdff1">std::nibble</a> trailerIndex = 0; trailerIndex &lt; currentThread-&gt;instruction.args[argumentIndex].trailerCount &amp;&amp; trailerIndex &lt; 4; trailerIndex++)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="comment">// Decode next word</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                decoded = 0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                decoded |= <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, executableIndex + 0) &lt;&lt; 24;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                decoded |= <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, executableIndex + 1) &lt;&lt; 16;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                decoded |= <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, executableIndex + 2) &lt;&lt; 8;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                decoded |= <a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">std::read</a>(&amp;currentThread-&gt;executable.BinaryData, executableIndex + 3) &lt;&lt; 0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                executableIndex += 4;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <span class="comment">// Save</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                currentThread-&gt;instruction.args[argumentIndex].trailers[trailerIndex] = decoded;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="comment">// Now that the instruction has been decoded, set eip to executableIndex</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="../../de/dfe/namespaceBBP_1_1userspace.html#a9122f01317e629b0ae11a837667f1224">setRegister</a>(currentThread-&gt;eip, currentThread-&gt;executable.physicalToVirtual(executableIndex));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::except &amp;<a class="code" href="../../d6/d2d/namespaceBBP_1_1Locale_1_1Japanese.html#a02c028a34a00f11967f61a67255e0e6eaa942c2da6dc667c4a5a36a37034d3a72">e</a>)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">// Doesn&#39;t really matter what happens, just signal fault</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="../../d0/def/Signal_8h.html#a82e69d819748cab5933309bba1999f7c">__SIGNAL__</a>(<a class="code" href="../../dd/d98/namespaceBBP_1_1std.html#af139a9b42bd35d198ce80ed26f7d2efe">SIGTHREXP</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor_acf57271f473cebb9e24e3afbd9b21e6b_cgraph.png" border="0" usemap="#d8/d9c/classBBP_1_1userspace_1_1HyperVisor_acf57271f473cebb9e24e3afbd9b21e6b_cgraph" alt=""/></div>
<map name="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_acf57271f473cebb9e24e3afbd9b21e6b_cgraph" id="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_acf57271f473cebb9e24e3afbd9b21e6b_cgraph">
<area shape="rect" title=" " alt="" coords="5,115,225,156"/>
<area shape="rect" href="../../d0/dc2/classBBP_1_1userspace_1_1BinaryExecutable.html#af46ca1c3ec18196e50f62e7bda446b6b" title=" " alt="" coords="273,5,516,47"/>
<area shape="rect" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e" title=" " alt="" coords="338,71,451,98"/>
<area shape="rect" href="../../de/dfe/namespaceBBP_1_1userspace.html#a484d19b0d23141290394e25753c95bfb" title=" " alt="" coords="288,122,501,149"/>
<area shape="rect" href="../../de/dfe/namespaceBBP_1_1userspace.html#a9122f01317e629b0ae11a837667f1224" title=" " alt="" coords="293,173,497,199"/>
<area shape="rect" href="../../d0/dc2/classBBP_1_1userspace_1_1BinaryExecutable.html#a96eb4539fc4f247710a8c1effabea87e" title=" " alt="" coords="273,224,516,265"/>
<area shape="rect" href="../../dd/d98/namespaceBBP_1_1std.html#a750ba4c285e0788e84722a30a776b913" title=" " alt="" coords="564,173,712,199"/>
</map>
</div>

</div>
</div>
<a id="ad9a896aeb26e67c14605bc5885d4338a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a896aeb26e67c14605bc5885d4338a">&#9670;&nbsp;</a></span>spawnThread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d8b/structBBP_1_1userspace_1_1Thread.html">BBP::userspace::Thread</a> * BBP::userspace::HyperVisor::spawnThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d63/classBBP_1_1std_1_1ELF_1_1ELFBuilder.html">std::ELF::ELFBuilder</a> &amp;&#160;</td>
          <td class="paramname"><em>binary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d73/classBBP_1_1std_1_1ResourceManager.html">std::ResourceManager</a> *&#160;</td>
          <td class="paramname"><em>allocator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/df1/ThreadState_8cpp_source.html#l00009">9</a> of file <a class="el" href="../../d8/df1/ThreadState_8cpp_source.html">ThreadState.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="comment">// Get next available PID</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="../../de/dfe/namespaceBBP_1_1userspace.html#ada35073b18ce8a7b788f5bd62ffd477d">pid_t</a> threadPID = <a class="code" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a700fe3adfc4bee534fb242852eaf74d0">allocateThread</a>();</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment">// Get thread</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    userspace::Thread *t = &amp;<a class="code" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a3cf04c5636244f4eb89c24496b8f709b">threads</a>.static_data[threadPID];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// Set active</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    t-&gt;active = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#adb775465cf5dc74bcb411a5969ebddd8">activeThread</a> = threadPID;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// Set page</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    t-&gt;executable.loadExecutable(binary, allocator);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    t-&gt;executable.createTLS(t-&gt;TLS);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    t-&gt;allocator = allocator;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// Set eip</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="../../de/dfe/namespaceBBP_1_1userspace.html#a9122f01317e629b0ae11a837667f1224">userspace::setRegister</a>(t-&gt;eip, binary.entry());</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// Return thread</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">return</span> t;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor_ad9a896aeb26e67c14605bc5885d4338a_cgraph.png" border="0" usemap="#d8/d9c/classBBP_1_1userspace_1_1HyperVisor_ad9a896aeb26e67c14605bc5885d4338a_cgraph" alt=""/></div>
<map name="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_ad9a896aeb26e67c14605bc5885d4338a_cgraph" id="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_ad9a896aeb26e67c14605bc5885d4338a_cgraph">
<area shape="rect" title=" " alt="" coords="5,121,208,162"/>
<area shape="rect" href="../../d0/dc2/classBBP_1_1userspace_1_1BinaryExecutable.html#af9382501257bd31fb11126a44007d18c" title=" " alt="" coords="256,91,499,133"/>
<area shape="rect" href="../../d3/d63/classBBP_1_1std_1_1ELF_1_1ELFBuilder.html#a875594f682445c582dfa17432639a68c" title=" " alt="" coords="286,13,469,54"/>
<area shape="rect" href="../../d0/dc2/classBBP_1_1userspace_1_1BinaryExecutable.html#a2eea354e4d1578fe320884a693aaaea6" title=" " alt="" coords="256,251,499,293"/>
<area shape="rect" href="../../de/dfe/namespaceBBP_1_1userspace.html#a9122f01317e629b0ae11a837667f1224" title=" " alt="" coords="275,157,479,184"/>
<area shape="rect" href="../../dd/d98/namespaceBBP_1_1std.html#a750ba4c285e0788e84722a30a776b913" title=" " alt="" coords="797,183,945,209"/>
<area shape="rect" href="../../dd/d98/namespaceBBP_1_1std.html#a997d77887946462f3e071f11465abfae" title=" " alt="" coords="577,56,718,83"/>
<area shape="rect" href="../../dc/dc2/ELFHeaderGettersSetters_8cpp.html#aa966c175861f53f0da77aef07282ab12" title=" " alt="" coords="605,5,689,32"/>
<area shape="rect" href="../../d6/d73/classBBP_1_1std_1_1ResourceManager.html#a2feb265bae9a30994a2a4a4f69306329" title=" " alt="" coords="547,361,748,402"/>
<area shape="rect" href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e" title=" " alt="" coords="591,259,704,285"/>
<area shape="rect" href="../../dd/d98/namespaceBBP_1_1std.html#aa63573041786d49b7cdb2eec8a921a6a" title=" " alt="" coords="589,309,706,336"/>
<area shape="rect" href="../../dd/d98/namespaceBBP_1_1std.html#ad23ea4bd936d0bd7f35a0aeef887e7bc" title=" " alt="" coords="796,368,947,395"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor_ad9a896aeb26e67c14605bc5885d4338a_icgraph.png" border="0" usemap="#d8/d9c/classBBP_1_1userspace_1_1HyperVisor_ad9a896aeb26e67c14605bc5885d4338a_icgraph" alt=""/></div>
<map name="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_ad9a896aeb26e67c14605bc5885d4338a_icgraph" id="d8/d9c/classBBP_1_1userspace_1_1HyperVisor_ad9a896aeb26e67c14605bc5885d4338a_icgraph">
<area shape="rect" title=" " alt="" coords="288,5,491,47"/>
<area shape="rect" href="../../d9/d6f/namespaceBBP.html#a0ba2e2ff83f9f917f9811058a5d02a0b" title=" " alt="" coords="108,13,240,39"/>
<area shape="rect" href="../../db/db7/Start_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title=" " alt="" coords="5,13,60,39"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="adb775465cf5dc74bcb411a5969ebddd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb775465cf5dc74bcb411a5969ebddd8">&#9670;&nbsp;</a></span>activeThread</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d98/namespaceBBP_1_1std.html#a4e12dc72cb7f796de80bc851c86c658e">std::index_t</a> BBP::userspace::HyperVisor::activeThread = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/dde/Hyperv_8h_source.html#l00020">20</a> of file <a class="el" href="../../d0/dde/Hyperv_8h_source.html">Hyperv.h</a>.</p>

</div>
</div>
<a id="aafbfe5628b61bda24d4f6e86455c6fb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafbfe5628b61bda24d4f6e86455c6fb4">&#9670;&nbsp;</a></span>activeThreadCount</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d98/namespaceBBP_1_1std.html#abd480c5a3803a8d9621cfdc79b051a7c">std::size_t</a> BBP::userspace::HyperVisor::activeThreadCount = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/dde/Hyperv_8h_source.html#l00019">19</a> of file <a class="el" href="../../d0/dde/Hyperv_8h_source.html">Hyperv.h</a>.</p>

</div>
</div>
<a id="a5c21ea8a3ad0e9a201f0770b70870e5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c21ea8a3ad0e9a201f0770b70870e5d">&#9670;&nbsp;</a></span>sharedlib</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/dc2/classBBP_1_1userspace_1_1BinaryExecutable.html">BinaryExecutable</a> BBP::userspace::HyperVisor::sharedlib</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/dde/Hyperv_8h_source.html#l00026">26</a> of file <a class="el" href="../../d0/dde/Hyperv_8h_source.html">Hyperv.h</a>.</p>

</div>
</div>
<a id="a572509d057f0f9af086655c9ae0fef73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a572509d057f0f9af086655c9ae0fef73">&#9670;&nbsp;</a></span>threadCount</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="../../dd/d98/namespaceBBP_1_1std.html#abd480c5a3803a8d9621cfdc79b051a7c">std::size_t</a> BBP::userspace::HyperVisor::threadCount = 16</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/dde/Hyperv_8h_source.html#l00018">18</a> of file <a class="el" href="../../d0/dde/Hyperv_8h_source.html">Hyperv.h</a>.</p>

</div>
</div>
<a id="a3cf04c5636244f4eb89c24496b8f709b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf04c5636244f4eb89c24496b8f709b">&#9670;&nbsp;</a></span>threads</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/dea/structBBP_1_1std_1_1STATIC__PAGE.html">std::STATIC_PAGE</a>&lt;<a class="el" href="../../d5/d8b/structBBP_1_1userspace_1_1Thread.html">Thread</a>, <a class="el" href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a572509d057f0f9af086655c9ae0fef73">threadCount</a>&gt; BBP::userspace::HyperVisor::threads</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/dde/Hyperv_8h_source.html#l00023">23</a> of file <a class="el" href="../../d0/dde/Hyperv_8h_source.html">Hyperv.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d0/dde/Hyperv_8h_source.html">Hyperv.h</a></li>
<li><a class="el" href="../../d5/d95/InstructionCycle_8cpp_source.html">InstructionCycle.cpp</a></li>
<li><a class="el" href="../../d8/df1/ThreadState_8cpp_source.html">ThreadState.cpp</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aSignal_8h_html_a82e69d819748cab5933309bba1999f7c"><div class="ttname"><a href="../../d0/def/Signal_8h.html#a82e69d819748cab5933309bba1999f7c">__SIGNAL__</a></div><div class="ttdeci">#define __SIGNAL__(sig)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/def/Signal_8h_source.html#l00009">Signal.h:9</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1std_html_a4926ba934876e4a1028b9abb47edbc56"><div class="ttname"><a href="../../dd/d98/namespaceBBP_1_1std.html#a4926ba934876e4a1028b9abb47edbc56">BBP::std::byte</a></div><div class="ttdeci">uint8_t byte</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dce/stddef_8h_source.html#l00030">stddef.h:30</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1userspace_html_ada35073b18ce8a7b788f5bd62ffd477d"><div class="ttname"><a href="../../de/dfe/namespaceBBP_1_1userspace.html#ada35073b18ce8a7b788f5bd62ffd477d">BBP::userspace::pid_t</a></div><div class="ttdeci">std::byte pid_t</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0e/Threading_8h_source.html#l00017">Threading.h:17</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1std_html_a46765daa6b14b3e45c22ad4071efdff1"><div class="ttname"><a href="../../dd/d98/namespaceBBP_1_1std.html#a46765daa6b14b3e45c22ad4071efdff1">BBP::std::nibble</a></div><div class="ttdeci">uint8_t nibble</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dce/stddef_8h_source.html#l00033">stddef.h:33</a></div></div>
<div class="ttc" id="aclassBBP_1_1userspace_1_1HyperVisor_html_a700fe3adfc4bee534fb242852eaf74d0"><div class="ttname"><a href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a700fe3adfc4bee534fb242852eaf74d0">BBP::userspace::HyperVisor::allocateThread</a></div><div class="ttdeci">pid_t allocateThread()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df1/ThreadState_8cpp_source.html#l00004">ThreadState.cpp:4</a></div></div>
<div class="ttc" id="aclassBBP_1_1userspace_1_1HyperVisor_html_a3cf04c5636244f4eb89c24496b8f709b"><div class="ttname"><a href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a3cf04c5636244f4eb89c24496b8f709b">BBP::userspace::HyperVisor::threads</a></div><div class="ttdeci">std::STATIC_PAGE&lt; Thread, threadCount &gt; threads</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dde/Hyperv_8h_source.html#l00023">Hyperv.h:23</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1std_html_a4e12dc72cb7f796de80bc851c86c658e"><div class="ttname"><a href="../../dd/d98/namespaceBBP_1_1std.html#a4e12dc72cb7f796de80bc851c86c658e">BBP::std::index_t</a></div><div class="ttdeci">word index_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dce/stddef_8h_source.html#l00048">stddef.h:48</a></div></div>
<div class="ttc" id="aclassBBP_1_1userspace_1_1HyperVisor_html_adb775465cf5dc74bcb411a5969ebddd8"><div class="ttname"><a href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#adb775465cf5dc74bcb411a5969ebddd8">BBP::userspace::HyperVisor::activeThread</a></div><div class="ttdeci">std::index_t activeThread</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dde/Hyperv_8h_source.html#l00020">Hyperv.h:20</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1userspace_html_a484d19b0d23141290394e25753c95bfb"><div class="ttname"><a href="../../de/dfe/namespaceBBP_1_1userspace.html#a484d19b0d23141290394e25753c95bfb">BBP::userspace::readRegister</a></div><div class="ttdeci">std::word readRegister(register_t &amp;reg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de4/Registers_8cpp_source.html#l00076">Registers.cpp:76</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1Locale_1_1Japanese_html_a02c028a34a00f11967f61a67255e0e6eaa942c2da6dc667c4a5a36a37034d3a72"><div class="ttname"><a href="../../d6/d2d/namespaceBBP_1_1Locale_1_1Japanese.html#a02c028a34a00f11967f61a67255e0e6eaa942c2da6dc667c4a5a36a37034d3a72">BBP::Locale::Japanese::e</a></div><div class="ttdeci">@ e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d54/Locale_8h_source.html#l00071">Locale.h:71</a></div></div>
<div class="ttc" id="aclassBBP_1_1userspace_1_1HyperVisor_html_a572509d057f0f9af086655c9ae0fef73"><div class="ttname"><a href="../../d8/d9c/classBBP_1_1userspace_1_1HyperVisor.html#a572509d057f0f9af086655c9ae0fef73">BBP::userspace::HyperVisor::threadCount</a></div><div class="ttdeci">static constexpr std::size_t threadCount</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dde/Hyperv_8h_source.html#l00018">Hyperv.h:18</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1std_html_ae104641b17c021a901add93f7bc5d808"><div class="ttname"><a href="../../dd/d98/namespaceBBP_1_1std.html#ae104641b17c021a901add93f7bc5d808">BBP::std::word</a></div><div class="ttdeci">uint32_t word</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dce/stddef_8h_source.html#l00015">stddef.h:15</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1std_html_af139a9b42bd35d198ce80ed26f7d2efe"><div class="ttname"><a href="../../dd/d98/namespaceBBP_1_1std.html#af139a9b42bd35d198ce80ed26f7d2efe">BBP::std::SIGTHREXP</a></div><div class="ttdeci">constexpr signal_t SIGTHREXP</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/def/Signal_8h_source.html#l00035">Signal.h:35</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1std_html_a11c4192c4c4747dbbd9300b0bc2db5d7"><div class="ttname"><a href="../../dd/d98/namespaceBBP_1_1std.html#a11c4192c4c4747dbbd9300b0bc2db5d7">BBP::std::SIGINV</a></div><div class="ttdeci">constexpr signal_t SIGINV</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/def/Signal_8h_source.html#l00027">Signal.h:27</a></div></div>
<div class="ttc" id="anamespaceBBP_1_1std_html_a1d232f50fc4e569e79449970f1b4bb9e"><div class="ttname"><a href="../../dd/d98/namespaceBBP_1_1std.html#a1d232f50fc4e569e79449970f1b4bb9e">BBP::std::read</a></div><div class="ttdeci">T &amp; read(PAGE&lt; T &gt; *page, index_t index)</div></div>
<div class="ttc" id="anamespaceBBP_1_1userspace_html_a9122f01317e629b0ae11a837667f1224"><div class="ttname"><a href="../../de/dfe/namespaceBBP_1_1userspace.html#a9122f01317e629b0ae11a837667f1224">BBP::userspace::setRegister</a></div><div class="ttdeci">void setRegister(register_t &amp;reg, std::word w)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de4/Registers_8cpp_source.html#l00007">Registers.cpp:7</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
